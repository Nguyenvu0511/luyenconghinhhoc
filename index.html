<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luy·ªán C√¥ng ƒê√†i: T·ªãnh Ti·∫øn & ƒê·ªëi X·ª©ng</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: url('https://placehold.co/1920x1080/000022/FFFFFF?text=Linh+Kh%C3%AD+%C4%90%E1%BA%A1i+Tr%E1%BA%ADn&font=playfairdisplay') no-repeat center center fixed;
            background-size: cover;
        }
        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        canvas {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 0.5rem;
            border: 1px solid rgba(255, 255, 255, 0.3);
            touch-action: none; /* Ch·ªëng cu·ªôn trang khi ch·∫°m tr√™n mobile */
        }
        input, button {
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }
        /* Giao di·ªán cho mobile */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            .controls, .canvas-container {
                width: 100% !important;
            }
            .controls {
                order: 2;
                max-height: none;
            }
            .canvas-container {
                order: 1;
                height: 40vh !important;
            }
        }
    </style>
</head>
<body class="text-white min-h-screen flex items-center justify-center p-4">

    <div class="main-container flex flex-col md:flex-row w-full max-w-6xl h-[90vh] glassmorphism rounded-xl shadow-2xl overflow-hidden">

        <!-- B·∫£ng ƒëi·ªÅu khi·ªÉn (T√¢m Ph√°p) -->
        <div class="controls w-full md:w-1/3 p-6 space-y-4 overflow-y-auto" style="max-height: 90vh;">
            <h1 class="text-2xl font-bold text-center text-yellow-300">üìú T√¢m Ph√°p ƒêi·ªÅu Khi·ªÉn üìú</h1>
            
            <div class="p-4 glassmorphism rounded-lg">
                <h2 class="text-lg font-semibold text-cyan-300 mb-2">Ph√©p 1: T·ªãnh Ti·∫øn (LƒÉng Ba Vi B·ªô)</h2>
                <div class="flex space-x-2">
                    <div class="flex-1">
                        <label for="dx" class="block text-sm">dx (Tr·ª•c Ho√†nh):</label>
                        <input type="number" id="dx" value="20" class="w-full bg-gray-900 text-white border border-cyan-400 rounded-md p-2 focus:ring-2 focus:ring-cyan-300 outline-none">
                    </div>
                    <div class="flex-1">
                        <label for="dy" class="block text-sm">dy (Tr·ª•c Tung):</label>
                        <input type="number" id="dy" value="20" class="w-full bg-gray-900 text-white border border-cyan-400 rounded-md p-2 focus:ring-2 focus:ring-cyan-300 outline-none">
                    </div>
                </div>
                <button id="translate" class="mt-2 w-full bg-cyan-500 hover:bg-cyan-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">‚ö° D·ªãch Chuy·ªÉn!</button>
            </div>

            <div class="p-4 glassmorphism rounded-lg">
                <h2 class="text-lg font-semibold text-green-300 mb-2">Ph√©p 2: ƒê·ªëi X·ª©ng (Ph√¢n Th√¢n ·∫¢nh Chi·∫øu)</h2>
                <div class="grid grid-cols-2 gap-2">
                    <button id="reflectX" class="bg-green-500 hover:bg-green-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">Tr·ª•c Ho√†nh (X)</button>
                    <button id="reflectY" class="bg-green-500 hover:bg-green-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">Tr·ª•c Tung (Y)</button>
                    <button id="reflectOrigin" class="col-span-2 bg-green-500 hover:bg-green-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">G·ªëc T·ªça ƒê·ªô (O)</button>
                </div>
            </div>

            <div class="p-4 glassmorphism rounded-lg">
                <h2 class="text-lg font-semibold text-yellow-300 mb-2">Ph√©p 3: Xoay (Chu Thi√™n V·∫≠n Chuy·ªÉn)</h2>
                <div>
                    <label for="angle" class="block text-sm">G√≥c (ƒë·ªô):</label>
                    <input type="number" id="angle" value="30" class="w-full bg-gray-900 text-white border border-yellow-400 rounded-md p-2 focus:ring-2 focus:ring-yellow-300 outline-none">
                </div>
                <button id="rotate" class="mt-2 w-full bg-yellow-500 hover:bg-yellow-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">üîÑ V·∫≠n Chuy·ªÉn!</button>
            </div>

            <div class="p-4 glassmorphism rounded-lg">
                <h2 class="text-lg font-semibold text-purple-300 mb-2">Ph√©p 4: T·ª∑ L·ªá (Ph√°p T·∫Øc Thi√™n ƒê·ªãa)</h2>
                <div class="flex space-x-2">
                    <div class="flex-1">
                        <label for="sx" class="block text-sm">T·ª∑ l·ªá X:</label>
                        <input type="number" id="sx" value="1.2" step="0.1" class="w-full bg-gray-900 text-white border border-purple-400 rounded-md p-2 focus:ring-2 focus:ring-purple-300 outline-none">
                    </div>
                    <div class="flex-1">
                        <label for="sy" class="block text-sm">T·ª∑ l·ªá Y:</label>
                        <input type="number" id="sy" value="1.2" step="0.1" class="w-full bg-gray-900 text-white border border-purple-400 rounded-md p-2 focus:ring-2 focus:ring-purple-300 outline-none">
                    </div>
                </div>
                <button id="scale" class="mt-2 w-full bg-purple-500 hover:bg-purple-400 text-black font-bold py-2 px-4 rounded-lg shadow-lg">üåå Ph√≥ng/Thu!</button>
            </div>

            <button id="reset" class="w-full bg-red-500 hover:bg-red-400 text-white font-bold py-2 px-4 rounded-lg shadow-lg">üî• Tr√πng Tu!</button>
        </div>

        <!-- Luy·ªán C√¥ng ƒê√†i (Canvas) -->
        <div class="canvas-container w-full md:w-2/3 p-6 flex flex-col h-full">
            <h1 class="text-2xl font-bold text-center text-yellow-300 mb-4">‚õ©Ô∏è Luy·ªán C√¥ng ƒê√†i H√¨nh H·ªçc ‚õ©Ô∏è</h1>
            <canvas id="canvas" class="flex-1 w-full h-full"></canvas>
            <div id="explanation" class="mt-4 p-4 glassmorphism rounded-lg text-yellow-200 h-24 overflow-y-auto">
                Ch∆∞ v·ªã ƒë·∫°o h·ªØu, h√£y ch·ªçn t√¢m ph√°p b√™n tr√°i ƒë·ªÉ b·∫Øt ƒë·∫ßu luy·ªán!
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            const explanation = document.getElementById('explanation');

            // N√∫t ƒëi·ªÅu khi·ªÉn
            const btnTranslate = document.getElementById('translate');
            const btnReflectX = document.getElementById('reflectX');
            const btnReflectY = document.getElementById('reflectY');
            const btnReflectOrigin = document.getElementById('reflectOrigin');
            const btnRotate = document.getElementById('rotate');
            const btnScale = document.getElementById('scale');
            const btnReset = document.getElementById('reset');
            
            // Input
            const inDx = document.getElementById('dx');
            const inDy = document.getElementById('dy');
            const inAngle = document.getElementById('angle');
            const inSx = document.getElementById('sx');
            const inSy = document.getElementById('sy');

            let originX, originY;
            
            // H√¨nh d·∫°ng g·ªëc (Linh Th·ªÉ Ban ƒê·∫ßu) - m·ªôt h√¨nh tam gi√°c
            const originalShape = [
                { x: 20, y: 20 },
                { x: 80, y: 20 },
                { x: 50, y: 80 }
            ];
            let currentShape = JSON.parse(JSON.stringify(originalShape));

            // Bi·∫øn cho animation
            let animationId = null;
            let targetShape = null;
            let previousShape = null; // H√¨nh d·∫°ng l√∫c b·∫Øt ƒë·∫ßu animation
            let animationStartTime = 0;
            const duration = 500; // 500ms cho m·ªói ph√©p bi·∫øn ƒë·ªïi

            // H√†m Easing (tƒÉng/gi·∫£m t·ªëc m∆∞·ª£t m√†)
            function easeInOutCubic(t) {
                return t < 0.5 ? 4 * t * t * t : 1 - Math.pow(-2 * t + 2, 3) / 2;
            }

            function resizeCanvas() {
                const container = canvas.parentElement;
                canvas.width = container.clientWidth;
                canvas.height = container.clientHeight;
                originX = canvas.width / 2;
                originY = canvas.height / 2;
                drawAll();
            }

            function drawAxes() {
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.lineWidth = 1;

                // Tr·ª•c X
                ctx.beginPath();
                ctx.moveTo(0, originY);
                ctx.lineTo(canvas.width, originY);
                ctx.stroke();

                // Tr·ª•c Y
                ctx.beginPath();
                ctx.moveTo(originX, 0);
                ctx.lineTo(originX, canvas.height);
                ctx.stroke();
            }
            
            // V·∫Ω h√¨nh d·∫°ng (linh th·ªÉ)
            function drawShape(shape, color, lineDash = []) {
                ctx.beginPath();
                ctx.strokeStyle = color;
                ctx.fillStyle = color.replace('1)', '0.3)');
                ctx.lineWidth = 2;
                ctx.setLineDash(lineDash);

                const firstPoint = shape[0];
                // Chuy·ªÉn ƒë·ªïi t·ªça ƒë·ªô t·ª´ to√°n h·ªçc (g·ªëc ·ªü gi·ªØa) sang canvas (g·ªëc ·ªü tr√™n c√πng b√™n tr√°i)
                // V√† l·∫≠t tr·ª•c Y (trong to√°n h·ªçc Y d∆∞∆°ng ƒëi l√™n, trong canvas Y d∆∞∆°ng ƒëi xu·ªëng)
                ctx.moveTo(originX + firstPoint.x, originY - firstPoint.y);
                
                for (let i = 1; i < shape.length; i++) {
                    const point = shape[i];
                    ctx.lineTo(originX + point.x, originY - point.y);
                }
                
                ctx.closePath();
                ctx.stroke();
                ctx.fill();
                ctx.setLineDash([]); // Reset line dash
            }

            // X√≥a v√† v·∫Ω l·∫°i t·∫•t c·∫£
            function drawAll() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                drawAxes();
                // V·∫Ω h√¨nh g·ªëc (b√≥ng m·ªù)
                drawShape(originalShape, 'rgba(255, 255, 255, 0.2)', [5, 5]);
                // V·∫Ω h√¨nh hi·ªán t·∫°i
                drawShape(currentShape, 'rgba(255, 215, 0, 1)'); // M√†u v√†ng kim
            }

            // V√≤ng l·∫∑p Animation
            function animate(timestamp) {
                if (!animationStartTime) animationStartTime = timestamp;
                const elapsed = timestamp - animationStartTime;
                let progress = Math.min(elapsed / duration, 1);
                progress = easeInOutCubic(progress); // √Åp d·ª•ng easing

                // N·ªôi suy v·ªã tr√≠ c√°c ƒëi·ªÉm
                currentShape = previousShape.map((p, i) => {
                    const target = targetShape[i];
                    return {
                        x: p.x + (target.x - p.x) * progress,
                        y: p.y + (target.y - p.y) * progress
                    };
                });

                drawAll(); // V·∫Ω l·∫°i canvas

                if (progress < 1) {
                    animationId = requestAnimationFrame(animate);
                } else {
                    // Animation k·∫øt th√∫c
                    animationId = null;
                    currentShape = JSON.parse(JSON.stringify(targetShape)); // Ch·ªët v·ªã tr√≠ cu·ªëi
                    previousShape = null;
                    targetShape = null;
                    animationStartTime = 0;
                }
            }

            // H√†m b·∫Øt ƒë·∫ßu m·ªôt animation m·ªõi
            function startAnimation(newTargetShape, explanationText) {
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    // N·∫øu ƒëang ch·∫°y d·ªü, l·∫•y v·ªã tr√≠ hi·ªán t·∫°i l√†m m·ªëc
                    previousShape = JSON.parse(JSON.stringify(currentShape));
                } else {
                    // N·∫øu ƒëang ƒë·ª©ng y√™n, l·∫•y v·ªã tr√≠ hi·ªán t·∫°i l√†m m·ªëc
                    previousShape = JSON.parse(JSON.stringify(currentShape));
                }

                targetShape = newTargetShape;
                explanation.innerHTML = explanationText;
                
                animationStartTime = 0; // Reset th·ªùi gian b·∫Øt ƒë·∫ßu
                animationId = requestAnimationFrame(animate); // B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p
            }


            // Ph√©p 1: T·ªãnh ti·∫øn
            btnTranslate.addEventListener('click', () => {
                const dx = parseFloat(inDx.value) || 0;
                const dy = parseFloat(inDy.value) || 0;
                
                const newTarget = currentShape.map(p => ({
                    x: p.x + dx,
                    y: p.y + dy
                }));
                
                const text = `üåü <b>T·ªãnh Ti·∫øn (D·ªãch Chuy·ªÉn):</b> Linh th·ªÉ ƒë√£ di chuy·ªÉn ${dx} ƒë∆°n v·ªã theo tr·ª•c Ho√†nh v√† ${dy} ƒë∆°n v·ªã theo tr·ª•c Tung. <br>ƒê√¢y ch√≠nh l√† <b>LƒÉng Ba Vi B·ªô</b>, di chuy·ªÉn m√† kh√¥ng thay ƒë·ªïi h√¨nh d·∫°ng!`;
                startAnimation(newTarget, text);
            });

            // Ph√©p 2: ƒê·ªëi x·ª©ng
            btnReflectX.addEventListener('click', () => {
                const newTarget = currentShape.map(p => ({
                    x: p.x,
                    y: -p.y
                }));
                const text = `üåü <b>ƒê·ªëi X·ª©ng Tr·ª•c X (·∫¢nh Chi·∫øu):</b> M·ªôt ph√¢n th√¢n ho√†n h·∫£o ƒë√£ ƒë∆∞·ª£c t·∫°o ra, ƒë·ªëi x·ª©ng qua m·∫∑t ƒë·∫•t (tr·ª•c Ho√†nh). <br><b>T√¢m ph√°p:</b> (x, y) ‚ûî (x, -y)`;
                startAnimation(newTarget, text);
            });

            btnReflectY.addEventListener('click', () => {
                const newTarget = currentShape.map(p => ({
                    x: -p.x,
                    y: p.y
                }));
                const text = `üåü <b>ƒê·ªëi X·ª©ng Tr·ª•c Y (Ph·∫£n Chi·∫øu):</b> M·ªôt ph√¢n th√¢n ho√†n h·∫£o ƒë√£ ƒë∆∞·ª£c t·∫°o ra, ƒë·ªëi x·ª©ng qua t·∫•m g∆∞∆°ng (tr·ª•c Tung). <br><b>T√¢m ph√°p:</b> (x, y) ‚ûî (-x, y)`;
                startAnimation(newTarget, text);
            });

            btnReflectOrigin.addEventListener('click', () => {
                const newTarget = currentShape.map(p => ({
                    x: -p.x,
                    y: -p.y
                }));
                const text = `üåü <b>ƒê·ªëi X·ª©ng G·ªëc T·ªça ƒê·ªô (ƒê·∫£o Ngh·ªãch):</b> M·ªôt ph√¢n th√¢n ƒë√£ ƒë∆∞·ª£c t·∫°o ra, ƒë·∫£o ng∆∞·ª£c ho√†n to√†n qua g·ªëc linh kh√≠ (g·ªëc O). <br><b>T√¢m ph√°p:</b> (x, y) ‚ûî (-x, -y)`;
                startAnimation(newTarget, text);
            });

            // Ph√©p 3: Xoay
            btnRotate.addEventListener('click', () => {
                const angleDeg = parseFloat(inAngle.value) || 0;
                const angleRad = angleDeg * Math.PI / 180;
                const cos = Math.cos(angleRad);
                const sin = Math.sin(angleRad);

                const newTarget = currentShape.map(p => ({
                    x: p.x * cos - p.y * sin,
                    y: p.x * sin + p.y * cos
                }));
                const text = `üåü <b>Xoay (Chu Thi√™n V·∫≠n Chuy·ªÉn):</b> Linh th·ªÉ ƒë√£ xoay ${angleDeg} ƒë·ªô quanh g·ªëc. <br><b>T√¢m ph√°p:</b> (x, y) ‚ûî (x*cosŒ∏ - y*sinŒ∏, x*sinŒ∏ + y*cosŒ∏)`;
                startAnimation(newTarget, text);
            });

            // Ph√©p 4: T·ª∑ l·ªá
            btnScale.addEventListener('click', () => {
                const sx = parseFloat(inSx.value) || 1;
                const sy = parseFloat(inSy.value) || 1;

                const newTarget = currentShape.map(p => ({
                    x: p.x * sx,
                    y: p.y * sy
                }));
                const text = `üåü <b>T·ª∑ L·ªá (Ph√°p T·∫Øc Thi√™n ƒê·ªãa):</b> Linh th·ªÉ ƒë√£ ${sx > 1 || sy > 1 ? 'ph√≥ng ƒë·∫°i' : 'thu nh·ªè'} v·ªõi t·ª∑ l·ªá ${sx} (tr·ª•c X) v√† ${sy} (tr·ª•c Y). <br><b>T√¢m ph√°p:</b> (x, y) ‚ûî (x*sx, y*sy)`;
                startAnimation(newTarget, text);
            });

            // Reset
            btnReset.addEventListener('click', () => {
                const newTarget = JSON.parse(JSON.stringify(originalShape));
                const text = `üî• <b>Tr√πng Tu!</b> Linh th·ªÉ ƒë√£ quay v·ªÅ tr·∫°ng th√°i ban ƒë·∫ßu, s·∫µn s√†ng cho v√≤ng luy·ªán c√¥ng m·ªõi!`;
                startAnimation(newTarget, text);
            });
            
            // X·ª≠ l√Ω touch/swipe cho mobile
            let touchStartX = 0;
            let touchStartY = 0;
            let touchShape = null;

            canvas.addEventListener('touchstart', (e) => {
                e.preventDefault();
                // Ng·ª´ng animation n·∫øu ƒëang ch·∫°y
                if (animationId) {
                    cancelAnimationFrame(animationId);
                    animationId = null;
                    animationStartTime = 0;
                }
                
                const touch = e.touches[0];
                // Chuy·ªÉn ƒë·ªïi t·ªça ƒë·ªô touch v·ªÅ t·ªça ƒë·ªô "to√°n h·ªçc"
                touchStartX = touch.clientX - canvas.getBoundingClientRect().left - originX;
                touchStartY = originY - (touch.clientY - canvas.getBoundingClientRect().top);
                touchShape = JSON.parse(JSON.stringify(currentShape));
            }, { passive: false });

            canvas.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (!touchShape) return;
                const touch = e.touches[0];
                const touchMoveX = touch.clientX - canvas.getBoundingClientRect().left - originX;
                const touchMoveY = originY - (touch.clientY - canvas.getBoundingClientRect().top);

                const dx = touchMoveX - touchStartX;
                const dy = touchMoveY - touchStartY;
                
                // √Åp d·ª•ng t·ªãnh ti·∫øn d·ª±a tr√™n v·ªã tr√≠ touch (kh√¥ng d√πng animation m∆∞·ª£t)
                currentShape = touchShape.map(p => ({
                    x: p.x + dx,
                    y: p.y + dy
                }));

                drawAll();
                explanation.innerHTML = `üåü <b>T·ªãnh Ti·∫øn (D·ªãch Chuy·ªÉn):</b> Linh th·ªÉ ƒëang di chuy·ªÉn theo ng√≥n tay c·ªßa c·∫≠u!`;
            }, { passive: false });

            canvas.addEventListener('touchend', (e) => {
                e.preventDefault();
                touchShape = null;
                // C·∫≠p nh·∫≠t previousShape ƒë·ªÉ animation ti·∫øp theo (n·∫øu c√≥) b·∫Øt ƒë·∫ßu t·ª´ ƒë√¢y
                previousShape = JSON.parse(JSON.stringify(currentShape));
            }, { passive: false });

            // Kh·ªüi t·∫°o v√† v·∫Ω l·∫ßn ƒë·∫ßu
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
        });
    </script>
</body>
</html>

